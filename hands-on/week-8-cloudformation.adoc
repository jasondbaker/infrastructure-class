:doctype: article
:blank: pass:[ +]

:sectnums!:

= SEIS 615 Week 8 Project: CloudFormation
Jason Baker <bake2352@stthomas.edu>
3.0, 8/29/2021

== Overview
Create a basic webserver failover architecture in AWS using a CloudFormation template.

== Requirements

  * AWS account.
  * Code editor

== The project

Let's get started!

=== Create a CloudFormation template.

In this week's class project, you will create a CloudFormation template to build a basic stack which includes an 
application load balancer and two webservers. Modifying template code requires a code editor. Here is a list of 
some popular free editors:

  * Atom (https://atom.io/)
  * Visual Studio Code (https://code.visualstudio.com/)
  * Notepad++ (https://notepad-plus-plus.org/)

You can review the class powerpoint presentation, AWS CloudFormation documentation, and YouTube resources if you
need help to figure out how to configure a resource. The AWS CloudFormation Resources documentation is particularly
helpful:

    https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html

You may use the template below as a starting point for the project. 

    https://s3.amazonaws.com/seis615/BasicVPC.yaml


The template will create a stack containing a basic VPC environment:

    * VPC
    * Internet Gateway
    * Two public subnets
    * Routing table with an Internet route
    * Webserver security group
    * An instance profile


image:../images/week-8-cf-project.png["800","800"]

Start by adding an input parameter called *InstanceType* which allows a user to specify the webserver instance type. The parameter should allow the user to select from a t2.micro or t2.medium instance type, defaulting to a t2.micro instance.

You will need to add two webservers with logical names of *Web1* and *Web2* to this template. The webservers should use the *ami-031a2e82d50ed8905* AMI and be associated with the *WebserverSG* security group. These websevers should also reference the *ClassInstanceProfile* instance profile to enable AWS Session Manager access.

You will also need to add an application load balancer using the following resouces: a load balancer resource with the logical name *WebAlb*, an ELB listerner resource with the logical name *WebAlbListener*, and a target group with the logical name *WebAlbTG*. The load balancer will verify the health of target instances using the index path (/index.php) endpoint.

[IMPORTANT]
====
CloudFormation considers application load balancers to be a version 2 (V2) ELB resource meaning that you need to use the AWS::ElasticLoadBalancingV2 resource types. The original load balancing type was designed for Classic ELBs and it will not work for this project.
====

The ALB is associated with the *WebserverSG* security group.

The first step is to figure out which resources you need to add to the template. Create a list of AWS resources you need to
add and review the CloudFormation documentation to understand the associated resource types. Each resource has a set of 
properties which must be set. You can try to launch your template using the CloudFormation dashboard once you have added the 
resources and associated properties to your template file.

Oftentimes you will find that working with infrastructure templates is a trial-and-error process. It's unlikely that you
will succeed on your first attempt when launching a newly built template. Review the CloudFormation events carefully to 
determine what is causing a template to fail, and then make the necessary code changes to fix the issue. 

=== Taskus extraordinarius (optional)

Add the following:

    * An input parameter called *ExpandServers* which allows the user to optionally (yes/no) create a third webserver instance.
    * A private subnet
    * A NAT gateway


=== Show me your work

Please show me your template code.

=== Terminate AWS resources

Remember to terminate all the resources created in this project, including the stack created by your
template.
